---
title: "Introducción al Tratamiento de Imágenes Satélite"
author: "Vanessa Covrig Covrig y Estrella Dominguez Sanchez"
date: ''
output:
  html_document:
    fig_caption: yes
    number_sections: no
    theme: yeti
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    df_print: kable
    latex_engine: xelatex
    fig_caption: yes
    number_sections: yes
    toc: yes
    toc_depth: 3
  word_document:
    toc: yes
    toc_depth: '3'
always_allow_html: yes
---
<style>
body h2 {
  font-size: 20px;
  color: blue;
}
</style>

<style>
body h1 {
  font-weight: bold;
  font-size: 30px;
  color: ;
}
</style>



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.aling="center")
```

# Introducción a las imágenes Satelitales

## ¿Qué es una imagen satélite?

Las imagenes satélites son fotografias tomadas por satélites artificiales, que muestran la geografia de un territorio específico o el espectro determinado de ondas electromagnéticas.

## ¿Pór que necesitamos procesar las imagenes satelitales?

El propósito del procesamiento digital de imágenes, es el de resaltar elementos que son dificiles de percibir o no se pueden distinguir directamente en una imagen. En el procesamiento digital de imágenes, normalmente se utilizan varias bandas espectrales de un mismo satélite.


# Paquetes de R para trabajar con imágenes Satélites


## Sen2r

Este paquete de R nos ayuda a descargar Y procesar las imagenes Sentinel-2 (2 satélites                                     multiespectrales de órbita polar, para la monitorización de la Tierra.) 


## Getlandsat

El paquete getlandsat nos facilita el acceso a las imágenes Landsat 8 (Las imágenes Landsat 8 obtenidas por el sensor (OLI) y (TIRS) constan de nueve bandas espectrales con una resolución espacial de 30 metros para las bandas de 1-7)
    
    
## MODIS
    
  El paquete MODIS para trabajar con imágenes satélite nos permite procesar y obtener archivos de  LP DAAC, LAADS y NSIDC (Moderate-Resolution Imaging Spectroradiometer (MODIS) es un instrumento científico lanzado por la NASA en 1999 a bordo del satélite Terra (EOS AM) y en 2002 a bordo del satélite Aqua. Permite medir la temperatura de la superficie, los sedimentos y fitoplancton del océano...)

  
# Sen2r

Hemos decidido usar el paquete Sen2r debido a su facilidad de manejo, ya que dispone de una interfaz, la cual se puede configurar dependiendo de las intenciones de cada usuario, además de un procesamiento integrado el cual nos facilita el preprocesamiento de las imagénes satélite.

## Primeros pasos con Sen2r
Primero necesitaremos registrarnos en esta página para poder acceder a las imágenes satélite y a las funciones del paquete: https://scihub.copernicus.eu/dhus/#/home

Después de registrarnos ejecutaremos el paquete Sen2r junto a unas librerias necesarias para su correcto funcionamiento e iniciaremos sesión con las credenciales anteriores.

```{r eval = FALSE}
library(sen2r())
write_scihub_login(username = "vancovx", password = "trabajomates")

library(leafpm)
library(mapedit)
library(shinyFiles)
library(shinydashboard)
library(shinyjs)
library(shinyWidgets)

```
## Importación de imágenes
Para importar las imágenes necesitamos especificar un par de parámetros explicados a continuación: 
```{r eval = FALSE}
#Definimos una ventana temporal para buscar entre esas dos fechas
time_window <- as.Date(c("2020-05-01","2020-05-05"))
#Definimos la escena en la que vamos a trabajar (El tile); 30TXM es de Zaragoza
tile = "30TXM"
#Porcentaje de nubes maximo que aparecera en nuestra imagen
max_cloud = 20

```
Después comprobamos el recibimiento de imágenes y descargamos la imagen en un directorio.
```{r eval = FALSE}
#Comprobamos que existen imágenes con esas caracteristicas
list_safe <- s2_list(tile = tile, time_interval = time_window, max_cloud = max_cloud)

#Comprobamos los metadatos que nos devuelve la lista anterior
safe_getMetadata(list_safe, "sensing_datetime")
safe_getMetadata(list_safe, "nameinfo")

#Creamos un directorio para descargar ahi la imagen
path <- "C:/Users/estre/OneDrive/Escritorio/UNI/Mates ii/R/Trabajo/"

#Le añadimos una carpeta nueva a la ruta anterior
path_save <- paste0(path,"prueba/")
dir.create(path_save)

#Guardamos la imagen en la ruta creada
s2_download(list_safe, outdir = path_save)

#Creamos un directorio que contiene todas las carpetas
dirs <- list.dirs(path = path_save)

#Aplicamos un filtro para que nos seleccione solamente las carpetas que contienen "IMG_DATA", que es la carpeta que contiene todas las imagenes
dirs <- dirs[grep("IMG_DATA", dirs)]

#Creamos una variable que liste todos los archivos de la carpeta
v_files <- list.files(dirs[1], full.names = TRUE, recursive = TRUE)

#Accedemos al objeto 2 (empieza desde la posicion 1)
print(v_files[2])

#Filtramos los archivos para que nos selecciones solamente los que terminan por 20m.jp2
v_files <- list.files(path = path_save, pattern = "20m.jp2", full.names = TRUE, recursive = TRUE)
```

```{r eval = FALSE}





```
















# Bibliografía

